import re
BOT_TOKEN = "8588537913:AAF8yxyeQBHbpdN4aJHpfp5-DUxFvQaUb10"

# --- 2. إعدادات الأحياء (المدينة المنورة) ---
# تم ترتيبها وتنظيفها لضمان مطابقة أدق
CITIES_DISTRICTS = {
    "مكة المكرمة": [
        "الشوقية", "العزيزية", "الرصيفة", "بطحاء قريش", "العوالي", "الشرائع", 
        "النزهة", "الزايدي", "ولي العهد", "الكعكية", "المسفلة", "العتيبية",
        "النوارية", "العمرة", "البحيرات", "جبل النور", "سلطانة", "الخالدية",
        "الزاهر", "الشهداء", "الفيحاء", "العدل", "الغسالة", "جبل السيدة",
        "الششة", "الروضة", "المعابدة", "جرول", "التيسير", "ريع بخش", "اجياد",
        "الهجرة", "كدي", "الملك فهد", "الاسكان", "الشبيكة", "القشلة", "الحجون",
        "المنصور", "الهنداوية", "الطنباوي", "الزهراء", "الضيافة", "الجامعة",
        "مخطط البنك", "مخطط الشريف", "الخنساء", "الجميزة", "الملاوي", "المعيصم",
        "الغزال", "الحكير", "النسيم", "جعرانة", "شرائع المجاهدين", "شرائع النخل", 
        "العكيشية", "الخضراء", "الراشدية", "الوسيق", "بئر الغنم", "وادي جليل", 
        "مقرح", "الشرشورة", "أم الجود", "الحرم", "المسجد الحرام", "برج الساعة", 
        "محطة القطار", "قطار الحرمين", "مكة مول", "الحجاز مول", "سوق الضيافة"
    ],
    
    "جدة": [
        "الروضة", "الخالدية", "الشاطئ", "الزهراء", "السلامة", "النعيم", "البساتين",
        "المرجان", "المحمدية", "أبحر الشمالية", "أبحر الجنوبية", "النزهة", "الربوة",
        "البوادي", "الصفا", "المروة", "الفيصلية", "أبحر", "زمرد", "الياقوت", 
        "اللؤلؤ", "الفنار", "أعالي جدة", "جوهرة العروس", "الفروسية", "التحلية", 
        "الاندلس", "الحمراء", "الرويس", "الشرفية", "مشرفة", "العزيزية", "الرحاب", 
        "النسيم", "بني مالك", "الورود", "الفيحاء", "الثغر", "الروابي", "السليمانية", 
        "السامر", "المنار", "الاجواد", "الالفيية", "الحمدانية", "الصالحية", "الرحمانية", 
        "الريان", "الكوثر", "الفلاح", "طيبة", "التيسير", "بريمان", "النخيل", 
        "البلد", "البغدادية", "السبيل", "الهنداوية", "الكندرة", "الوزيرية", 
        "الجوهرة", "السنابل", "الاجاويد", "الخمرة", "القرينية", "المطار", 
        "محطة القطار", "الواجهة البحرية", "الرد سي مول", "عزيز مول", "الأندلس مول", 
        "جامعة الملك عبدالعزيز", "استاد الجوهرة", "حي الشفاء"
    ]
}
}
# --- 3. معالجة النصوص (الذكاء اللغوي) ---

def normalize_text(text):
    """تنظيف وتوحيد النصوص العربية لزيادة دقة البحث عن الأحياء والطلبات"""
    if not text: return ""

    # 1. تحويل للصغير وإزالة المسافات الزائدة
    text = text.strip().lower()

    # 2. إزالة التشكيل (فتحة، ضمة، إلخ)
    text = re.sub(r"[\u064B-\u0652]", "", text)

    # 3. توحيد الحروف المتشابهة
    replacements = {
        "أ": "ا", "إ": "ا", "آ": "ا",
        "ة": "ه", "ى": "ي", "ئ": "ي", "ؤ": "و"
    }
    for old, new in replacements.items():
        text = text.replace(old, new)

    # 4. إزالة تكرار الحروف (مشوااااار -> مشوار)
    text = re.sub(r'(.)\1+', r'\1', text)

    # 5. معالجة الـ التعريف لزيادة مرونة البحث
    # نقوم بإزالة "ال" إذا كانت تجعل الكلمة أكثر من 3 حروف (مثل العزيزية -> عزيزيه)
    words = text.split()
    clean_words = []
    for w in words:
        if w.startswith("ال") and len(w) > 3:
            clean_words.append(w[2:])
        else:
            clean_words.append(w)

    return " ".join(clean_words)
